# 维纳滤波器

## 1.维纳滤波器基础

维纳滤波器(wiener filtering)的本质是使估计误差(定义为期望响应与滤波器实际输出之差)均方值最小化。

![](img/维纳滤波器框图.png ':size=70%')

### 1.1 时域维纳滤波器

#### 1.1.1 基本原理

$$
\begin{aligned}
e(n) &=d(n)-\hat{d}(n) \\
&=d(n)-\mathbf{h}^{T} \mathbf{y}
\end{aligned}
$$

$\mathbf{h}^{T}=\left[h_{0}, h_{1}, h_{2}, \ldots, h_{M-1}\right]$为滤波器系数。 <br/>
$\mathbf{y}^{T}=[y(n), y(n-1), y(n-2), \ldots, y(n-M+1)]$为最近M个输入(1xM)。

为了寻找最优滤波器系数，需要最小化$e(n)$的均方值。

$$
\begin{aligned}
J=E\left[e^{2}(n)\right] &=E\left(d(n)-\mathbf{h}^{T} \mathbf{y}\right)^{2} \\
&=E\left[d^{2}(n)\right]-2 \mathbf{h}^{T} E[\mathbf{y} d(n)]+\mathbf{h}^{T} E\left[\mathbf{y} \mathbf{y}^{T}\right] \mathbf{h} \\
&=E\left[d^{2}(n)\right]-2 \mathbf{h}^{T} \mathbf{r}_{y d}^{-}+\mathbf{h}^{T} \mathbf{R}_{y y} \mathbf{h}
\end{aligned}
$$

$\mathbf{r}_{y d}^{-} \triangleq E[\mathbf{y} d(n)]$是输入信号和期望信号的互相关矩阵(Mx1)。 <br/>
$\mathbf{R}_{y y}=E\left[\mathbf{y} \mathbf{y}^{T}\right]$是输入信号的自相关矩阵(MxM)。

$J$是一个$h$二次方程，所以存在一个全局最小值，对$h$求导，可以求极值。

$$
\frac{\partial J}{\partial \mathbf{h}}=-2 \mathbf{r}_{y d}^{-}+2 \mathbf{h}^{T} \mathbf{R}_{y y}=0
$$

最优滤波器系数(维纳-霍夫解)$\mathbf{h}^{*}$为：

$$
\mathbf{R}_{y y} \mathbf{h}^{*}=\mathbf{r}_{y d}^{-}
$$

$$
\mathbf{h}^{*}=\mathbf{R}_{y y}^{-1} \mathbf{r}_{y d}^{-}
$$

使用矩阵表示为：

$$
\left[\begin{array}{c}
h_{0} \\
h_{1} \\
h_{2} \\
\vdots \\
h_{M-1}
\end{array}\right]=\left[\begin{array}{ccccc}
r_{y y}(0) & r_{y y}(1) & r_{y y}(2) & \cdots & r_{y y}(M-1) \\
r_{y y}(1) & r_{y y}(0) & r_{y y}(1) & \cdots & r_{y y}(M-2) \\
r_{y y}(2) & r_{y y}(1) & r_{y y}(0) & \cdots & r_{y y}(M-3) \\
\vdots & \vdots & \vdots & \ddots & \vdots \\
r_{y y}(M-1) & r_{y y}(M-2) & \cdots & r_{y y}(1) & r_{y y}(0)
\end{array}\right]\left[\begin{array}{c}
r_{y d}(0) \\
r_{y d}(-1) \\
r_{y d}(-2) \\
\vdots \\
r_{y d}(-M+1)
\end{array}\right]
$$

#### 1.1.2 matlab实现分析

```matlab
clc;
N = 5000;
n = linspace(0,1200,N);

s = 2*sin(pi*n/128+pi/3)';
v = sqrt(1.25)*randn(N,1);
Y = s + v;

[C,lags] = xcorr(Y,N,'biased');
C1 = toeplitz(C(N+1:end));

C2 = xcorr(s,Y,N,'biased');
C2 = C2(N+1:end);

Wopt = inv(C1) * C2;
y = filter(Wopt,1,Y);

subplot(311)
plot(n,s);
axis([0 1200 -4 4]);
title('clean');
subplot(312)
plot(n,y);
axis([0 1200 -4 4]);
title('wiener');
subplot(313)
plot(n,Y);
axis([0 1200 -4 4]);
title('noisy');
```

![](img/时域维纳滤波器matlab.png ':size=70%')

### 1.2 频域维纳滤波器











